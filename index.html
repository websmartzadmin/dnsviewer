<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>DNS Check</title>
  <style>
    body { font-family: Arial, sans-serif; line-height: 1.5; padding: 20px; }
    h2 { margin: 0 0 8px; }
    pre { background: #f8f8f8; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
    .muted { color: #666; font-size: 12px; margin-top: 4px; }
  </style>
</head>
<body>
  <h2>DNS Records</h2>
  <p><strong>Domain:</strong> <span id="rootLabel"></span></p>

  <h3>Root A Record</h3>
  <pre id="rootA">Loading…</pre>

  <h3>www CNAME Record</h3>
  <pre id="wwwCNAME">Loading…</pre>

  <script>
    const params = new URLSearchParams(location.search);
    const rawInput = params.get("domain") || "";

    function normalizeDomain(s) {
      return (s || "")
        .trim()
        .replace(/^https?:\/\//i, "")
        .replace(/[#?].*$/, "")
        .replace(/\/.*$/, "")
        .replace(/^www\./i, "");
    }

    const root = normalizeDomain(rawInput);
    const www = root ? `www.${root}` : "";

    document.getElementById("rootLabel").textContent = root || "(none)";

    if (root) {
      showA(root, "rootA");
      showCNAME(www, "wwwCNAME");
    } else {
      document.getElementById("rootA").textContent = "No domain provided.";
      document.getElementById("wwwCNAME").textContent = "No domain provided.";
    }

    async function doh(name, type) {
      const url = `https://dns.google/resolve?name=${encodeURIComponent(name)}&type=${encodeURIComponent(type)}`;
      const res = await fetch(url);
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      return res.json();
    }

    async function showA(name, preId) {
      const pre = document.getElementById(preId);
      try {
        const json = await doh(name, "A");
        const answers = (json.Answer || []).filter(r => r.type === 1).map(r => r.data);
        pre.textContent = answers.length ? answers.join("\n") : "None found";
      } catch (e) {
        pre.textContent = `Error: ${e.message || e}`;
      }
    }

    async function showCNAME(name, preId) {
      const pre = document.getElementById(preId);
      try {
        const json = await doh(name, "CNAME");
        const answers = (json.Answer || []).filter(r => r.type === 5).map(r => r.data);
        pre.textContent = answers.length ? answers.join("\n") : "None found";
      } catch (e) {
        pre.textContent = `Error: ${e.message || e}`;
      }
    }
  </script>
</body>
</html>
